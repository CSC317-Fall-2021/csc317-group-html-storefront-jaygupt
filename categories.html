<!DOCTYPE html>
<html lang="en">

<head>
    <title>Categories</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/categories.css">
</head>

<body leftmargin="0" topmargin="0">
    <!-- Navbar Beginning -->
    <header>
        <nav class="navbar">
            <h1 id="logo"><a href="index.html" id="logo-text"><span class="logo-g">G</span>ood<span
                        class="logo-g">G</span>ame</a></h1>
            <a href="index.html">HOME</a>
            <a href="#" class="current">CATEGORIES</a>
            <input type="text" placeholder="Search products..." id="productSearch">
            <a href="login.html">LOGIN/REGISTER</a>
            <a href="cart.html">CART</a>
            <a href="about_us.html">ABOUT</a>
        </nav>
    </header>
    <!-- Navbar Ending -->

    <div id="categories"></div>

    <!-- Footer Beginning -->
    <footer class="footer">
        <p>GoodGame.com, Copyright &copy;2021</p>
    </footer>
    <!-- Footer Ending -->

    <!-- Script Tags -->
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript">
        /* add elements to DOM */
        const categoriesDivElement = document.getElementById("categories");

        // loop through categories array defined in main.js
        for (let i = 0; i < categories.length; i++) {
            const category = categories[i];

            // <div class="category slider">
            const categorySliderDivElement = document.createElement("div");
            categoriesDivElement.appendChild(categorySliderDivElement);

            // <div class="category-title">Action Figures</div>
            categorySliderDivElement.classList.add("category", "slider");
            const categoryTitleDivElement = document.createElement("div");
            categoryTitleDivElement.className = "category-title";
            categorySliderDivElement.appendChild(categoryTitleDivElement);
            categoryTitleDivElement.textContent = category;

            // <div class="slider-inner">
            const innerSliderDivElement = document.createElement("div");
            innerSliderDivElement.className = "slider-inner";
            categorySliderDivElement.appendChild(innerSliderDivElement);

            // find products in category
            const productsInCategory = findProductsInCategory(category)

            // loop through each product in category, create product div elements
            for (let j = 0; j < productsInCategory.length; j++) {
                const product = productsInCategory[j];

                // get information on product
                const productInformation = findProduct(product);

                // <div class="product">
                const productDivElement = document.createElement("div");
                innerSliderDivElement.appendChild(productDivElement);
                productDivElement.className = "product";

               /*
                <a href="product_pages/action_figures/captain_america.html">
                    <img class="item-image"
                        src="images/product_images/action_figures/captain_america.jpeg"
                        alt="Captain America">
                </a>
               */
               const productAElement = document.createElement("a");
               productDivElement.appendChild(productAElement);

               // get link to product page
               const linkToProductPage = getLinkToProductPage(product);
               productDivElement.appendChild(productAElement);
               productAElement.setAttribute("href", linkToProductPage);

               const productImage = document.createElement("img");
               productAElement.appendChild(productImage);
               productImage.className = "item-image";
               productImage.setAttribute("src", productInformation["imageSrc"]);
               productImage.setAttribute("alt", product);

               // <div class="product-title">Captain America</div>
               const productTitleDivElement = document.createElement("div");
               productDivElement.appendChild(productTitleDivElement);
               productTitleDivElement.className = "product-title";
               productTitleDivElement.textContent = product;

               // <div class="item-price">$29.99</div>
               const itemPriceDivElement = document.createElement("div");
               productDivElement.appendChild(itemPriceDivElement);
               itemPriceDivElement.className = "item-price";
               itemPriceDivElement.textContent = "$" + productInformation["price"];

               // <button class="btn add-to-cart">Add to Cart</button>
               const addToCartButton = document.createElement("button");
               productDivElement.appendChild(addToCartButton);
               addToCartButton.classList.add("btn", "add-to-cart");
               addToCartButton.textContent = "Add to Cart";
            }
        }
    </script>
    <!-- <script type="text/javascript" defer src="js/add_to_cart.js"></script> -->
    <script type="text/javascript" defer>
        /* carousel drag function */
        let sliders = document.getElementsByClassName("slider");
        let innerSliders = document.getElementsByClassName("slider-inner");

        for (let i = 0; i < sliders.length; i++) {
            let pressed = false;
            let startx;
            let x;

            const slider = sliders[i];
            const innerSlider = innerSliders[i];

            slider.addEventListener("mousedown", (e) => {

                pressed = true;
                startx = e.offsetX - innerSlider.offsetLeft;
                slider.style.cursor = "grabbing";
            });

            slider.addEventListener("mouseenter", () => {
                slider.style.cursor = "grab";
            });

            slider.addEventListener("mouseup", () => {
                slider.style.cursor = "grab";
            });

            window.addEventListener("mouseup", () => {
                pressed = false;
            });

            slider.addEventListener("mousemove", (e) => {
                if (!pressed) return;
                e.preventDefault();
                
                x = e.offsetX;
                
                innerSlider.style.left = `${x - startx}px`;
                checkBoundary();
            });

            function checkBoundary() {
                let outer = slider.getBoundingClientRect();
                let inner = innerSlider.getBoundingClientRect();
                
                if (parseInt(innerSlider.style.left) > 0) {
                    innerSlider.style.left = "0px";
                } else if (inner.right < outer.right) {
                    innerSlider.style.left = `-${inner.width - outer.width}px`;
                }
            }
        }
    </script>
</body>

</html>